---
import BaseLayout from "~/components/layout/BaseLayout.astro";
import { getCollection } from "astro:content";

export async function getStaticPaths() {
  const entries = await getCollection("projects");

  const esEntries = entries
    .filter((p) => p.data.locale === "es")
    .map((p) => {
      const slug = String(p.slug ?? "")
        .replace(/^es\//, "")
        .replace(/^en\//, "");
      return { entry: p, slug };
    })
    .filter((x) => x.slug.length > 0);

  return esEntries.map(({ entry, slug }) => ({
    params: { slug },
    props: { entry },
  }));
}

const { entry } = Astro.props;
const { Content } = await entry.render();
---

<BaseLayout title={entry.data.title} description={entry.data.summary} locale="es">
  <article>
    <h1>{entry.data.title}</h1>
    <p>{entry.data.summary}</p>
    <Content />
  </article>
</BaseLayout>
